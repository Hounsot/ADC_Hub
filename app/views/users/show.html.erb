<div class="SO_UserProfile">
  <div class="O_UserInformation">
    <div>
      <% if @user.avatar.attached? %>
        <%= image_tag @user.avatar.variant(resize_to_limit: [300, 300]) %>
      <% else %>
        <!-- Wrap the message in a clickable link -->
        <a href="#" id="toggle-upload">
          <%= image_tag asset_path("Q_DefaultAvatar.png"), alt: "Default avatar" %>
        </a>
        <!-- Hidden upload form -->
        <div id="upload-form" style="display: none;">
          <%= form_with model: @user, url: upload_avatar_user_path(@user), local: true, method: :patch, html: { multipart: true } do |f| %>
            <div>
              <%= f.label :avatar, "Upload Profile Picture" %><br>
              <%= f.file_field :avatar %>
            </div>
            <div>
              <%= f.submit "Upload" %>
            </div>
          <% end %>
        </div>
      <% end %>
      <% if @user.name.blank? && @user.surname.blank? %>
        <h1><%= current_user == @user ? "Your name" : "Name" %></h1>
      <% else %>
        <h1><%= @user.name %> <%= @user.surname %></h1>
      <% end %>
      <p>Описание...</p>
      <p><%= @user.email %></p>
    </div>
  </div>
  <div class="O_UserProjectsAndBanner">
    <p class="A_SmallTitle">Мое место работы</p>
    <div class="M_UserEmploymentBanner">
      <div class="W_EmploymentBannerText">
        <p class="A_BannerText"><span <%= @user.position.present? ? "test" : %q(class="Name") %>>Старший дизайнер</span> в <span class="U_Gray"><%= @user.company.name %></span></p>
        </div>
        <% if current_user == @user %>
          <div class="A_Button">Запросить рекомендацию</div>
        <% end %>
      </div>
      <p class="A_SmallTitle">Мои проекты</p>
      <div class="M_UserProjects"></div>
    </div>
  </div>
  <!-- Simple JavaScript to toggle the upload form -->
  <script>
    document.addEventListener("DOMContentLoaded", function(){
      var toggleLink = document.getElementById("toggle-upload");
      var uploadForm = document.getElementById("upload-form");
      if (toggleLink && uploadForm) {
        toggleLink.addEventListener("click", function(e){
          e.preventDefault();
          // Toggle the display style between none and block
          if (uploadForm.style.display === "none") {
            uploadForm.style.display = "block";
          } else {
            uploadForm.style.display = "none";
          }
        });
      }
    });
  </script>
